=== ПОТОК ПРОГРАММЫ

== Бесконечный цикл

Точка входа приложения в языках C и C++ находится в функции main(), которая объявлена в файле main.cpp. Она содержит бесконечный цикл, в котором создаётся объект Game. Цикл предназначен для того, чтобы игра могла перезапускаться без необходимости завершения процесса приложения. Это может быть использовано для переключения языка или режима графики на лету.

Чтобы перезапустить приложения, используйте метод Game::restart(). Он освободит ресурсы игры и запустит её заново с того экрана, на котором метод был вызван.

Бросьте 0 как исключение, если вы хотите освободить ресурсы и запустить приложение с первого экрана без сохранения его состояния.

Если какое-либо исключения не было обработано или игра была остановлена с помощью метода Game::stop(), бесконечный цикл в функции main() закончится.

== Обновление ввода и перерисовка экрана

Функция loop() класса Game содержит бесконечный цикл, обрабатывающий ввод от пользователя и перерисовывающий экран. Этот цикл разработан так, чтобы игра всегда выполнялась плавно. Вы можете настроить его поведение с помощью констант TICKS_PER_SECOND и MAX_FRAMESKIP.

Основная идея этого цикла заключается в том, чтобы разделить обработку ввода и перерисовку экрана. Если возможно, экран будет перерисован TICKS_PER_SECOND раз за секунду, но если это будет невозможно, некоторые кадры будут пропускаться. Цикл не может пропустить больше, чем MAX_FRAMESKIP кадров подряд, т.е. он перерисует экран, если пропустил MAX_FRAMESKIP кадров подряд. Перерисовка выполняется функцией redraw() класса Screen, которая вызывает функцию draw() у объектов класса Object.

Ввод от пользователя обрабатывается специальным классом Input. Ввод может обрабатываться чаще, чем происходит перерисовка экрана, чтобы игра могла реагировать на действия пользователя быстрее. Текущие состояния клавиатуры и мыши хранятся в классе Input. Объект класса Game содержит единственный объект класса Input, который обновляется внутри бесконечного цикла. Объекты Screen получают указатель на этот объект, и могут использовать его в функции update(). Чтобы и объекты на экране могли обновить своё состояние (например, кнопка может среагировать на нажатие клавиши и выполнить какое-нибудь действие), Screen передаёт этот указатель своим объектам Object.
