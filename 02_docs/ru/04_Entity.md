# Класс Entity

## Общая информация

Объекты класса Entity работают, обновляются и отрисовываются на экране. Они могут иметь «дочерних» Entity.

У каждого Entity есть x- и y- координата, а также приоритет отрисовки на экран. Entity с меньшим приоритетом отрисовываются раньше, то есть Entity с наибольшим приоритетом отрисуется последним (поверх предыдущих).

Entity могут быть невидимыми (не отрисовывающимися на экран) или отключенными (не отрисовывающимися и не обновляющимися).

В конструкторе Entity получают указатель на [Controller](05_Controller.md), который они могут использовать, чтобы запросить выполнение каких-либо общих действий.

## Наследование класса Entity

В классе Entity могут быть перегружены следующие функции:

##### `void redraw(int x, int y)`
Когда эта функция вызывается, Entity должен отрисоваться в указанной позиции (хотя может и проигнорировать данное указание).  
**redraw()** класса Entity вызывает виртуальную функцию **[redraw_before_queue()](04_Entity.md#void-redraw_before_queueint-x-int-y)**, потом отрисовывает всех своих «дочерних» Entity и вызывает виртуальную функцию **[redraw_after_queue()](04_Entity.md#void-redraw_after_queueint-x-int-y)**. Поэтому вы можете перегрузить одну из этих функций (или обе), если вам не нужно более сложного алгоритма отрисовки.  

----
##### `void update(int x, int y)`
Когда эта функция вызывается, Entity должен обновить своё состояние, будто он находится в указанной позиции (хотя может и проигнорировать данное указание).  
**redraw()** класса Entity вызывает виртуальную функцию **[update_before_queue()](04_Entity.md#void-update_before_queueint-x-int-y)**, потом обновляет всех своих «дочерних» Entity и вызывает виртуальную функцию **[update_after_queue()](04_Entity.md#void-update_after_queueint-x-int-y)**. Поэтому вы можете перегрузить одну из этих функций (или обе), если вам не нужно более сложного алгоритма обновления.

----
##### `void redraw_before_queue(int x, int y)`
Эта функция вызывается классом Entity перед отрисовкой своих «дочерних» Entity. Указанная позиция совпадает с переданной в функцию **[redraw()](04_Entity.md#void-redrawint-x-int-y)**.

----
##### `void redraw_after_queue(int x, int y)`
Эта функция вызывается классом Entity после отрисовки своих «дочерних» Entity. Указанная позиция совпадает с переданной в функцию **[redraw()](04_Entity.md#void-redrawint-x-int-y)**.

----
##### `void update_before_queue(int x, int y)`
Эта функция вызывается классом Entity перед обновлением своих «дочерних» Entity. Указанная позиция совпадает с переданной в функцию **[update()](04_Entity.md#void-updateint-x-int-y)**.

----
##### `void update_after_queue(int x, int y)`
Эта функция вызывается классом Entity после обновления своих «дочерних» Entity. Указанная позиция совпадает с переданной в функцию **[update()](04_Entity.md#void-updateint-x-int-y)**.

## Функции класса Entity

В классе Entity также есть несколько функций и методов для чтения и установки значений:

##### `void set_x(int)`
Устанавливает x-координату Entity.  

----
##### `void set_y(int)`
Устанавливает y-координату Entity.  

----
##### `void set_priority(int)`
Устанавливает приоритет Entity.  

----
##### `void set_visible(bool)`
Устанавливает видимость Entity. (видимый — **true**, невидимый — **false**)  

----
##### `void set_enabled(bool)`
Включает или выключает Entity. (чтобы включить, передайте **true**, чтобы выключить — **false**)    

----
##### `void destruct()`
Заставляет Entity исчезнуть и очистить память. Он автоматически будет удалён из очереди «дочерних» объектов своего «родителя».  

----
##### `int x()`
Возвращает x-координату Entity.  

----
##### `int y()`
Возвращает y-координату Entity.  

----
##### `int priority()`
Возвращает приоритет Entity.  

----
##### `bool visible()`
Возвращает видимость Entity. (если видимый — **true**, если нет — **false**)  

----
##### `bool enabled()`
Возвращает **true**, если Entity включён и **false**, если не включён.  

----
##### `bool destroy()`
Возвращает **true**, если Entity должен исчезнуть и очистить память (в противном случае — **false**).  

## Устройство класса Entity 

У Entity могут быть «дочерние» Entity, которых надо оповещать, чтобы те могли обновиться и отрисоваться на экране. У каждого Entity есть приоритет, поэтому нужно хранить их в порядке. Для этого в Entity есть специальная очередь и некоторые служебные функции для работы с ней. Ими следует пользоваться из перегруженных виртуальных функций.

Для работы с очередью «дочерних» Entity могут использоваться следующие функции:

##### `void add_object(Entity* entity, bool reorder = true)`
Добавляет новый «дочерний» Entity в очередь. Поскольку это может нарушить порядок в очереди, сразу после добавления можно упорядочить объекты в ней. Если вы добавляете много объектов за раз, лучше передать значение **false**, чтобы не переупорядочивать объекты после каждого добавления, и упорядочить их один раз после того, как все будут добавлены.  

----
##### `void clear_queue()`
Очищает очередь «дочерних» Entity, удаляя их.

----
##### `void redraw_queue(int x, int y)`
Отрисовывает все «дочерние» Entity в очереди на экране с указанным смещениям по осям X и Y.  

----
##### `void reorder_queue()`
Упорядочивает очередь в соответствии с приоритетами объектов в ней.  

----
##### `void update_queue(int x, int y)`
Оповещает «дочерние» Entity в очереди, чтобы они обновили своё состояние, если это потребуется, использовав данные класса [Input](08_Input.md).  
Передаёт им указанное смещение по осям X и Y.  
   
   
**Предыдущий файл:** [Класс Screen](03_Screen.md)  
**[Содержание](00_Contents.md)**  
**Следующий файл:** [Класс Controller](05_Controller.md)