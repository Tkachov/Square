# класс Game

## Общая информация

Класс Game выполняет бесконечный цикл, обрабатывающий ввод от пользователя и перерисовывающий экран.  
Он загружает и хранит разную информацию, такую как объекты класса [Screen](03_Screen.md), объекты [String_Table](07_String_Table.md) с настройками и локализацией, и т.д.  
Он содержит единственные экземпляры объектов класса [Input](08_Input.md) и [Loader](09_Loader.md), которыми вы можете пользоваться из других классов.  
В общем-то, вам не нужно изменять работу объекта Game, но эта информация всё равно может оказаться для вас полезной.

## Функции  

##### `Game()`
Конструктор, создаёт окно и открывает Screen, которому соответствует ScreenID **SCREENID_DEFAULT**.  

----
##### `~Game()`
Деструктор, очищает память.  

----
##### `void loop()`
Содержит цикл, который заставляет приложение работать.  

----
##### `void stop()`
Останавливает цикл приложения (и, следовательно, само приложение).  

----
##### `void open_screen(ScreenID sid, bool reload = false)`
Открывает Screen, которому соответствует переданный ScreenID **sid**.  
Перезагружает Screen (то есть создаёт новый экземпляр объекта), если параметр **reload** равен **true**.  
Эта функция сработает только если вы добавили свой класс, наследующий класс Screen, в функцию **[create_screen(ScreenID)](05_Game.md#screenid)**!

----
##### `void open_screen(Screen* screen)`
Открывает переданный Screen **screen**.  

----
##### `void save(string filename)`
Сохраняет текущее состояние игры в файле с переданным именем **filename** в подпапке "saves".
(Например, если **filename** равно "game.sav", то будет создан или перезаписан файл "saves\game.sav".)  

----
##### `void load(string filename)`
Загружает состояние игры из файла с переданным именем **filename** из подпапки "saves".  

----
##### `void save_options()`
Сохраняет настройки в файле "config.txt".  

----
##### `void restart()`
Перезапускает игру.  
Может использоваться, чтобы применить изменения настроек (если они критичны и требуют перезапуска).  

----
##### `int w()`
Возвращает ширину окна.  

----
##### `int h()`
Возвращает высоту окна.  

----
##### `State* state()`
Возвращает указатель на объект [State](11_State.md) текущей игры (его можно сохранить или получить из него значения переменных).  

----
##### `ScreenID sid()`
Возвращает ScreenID, соответствующий объекту Screen, открытому в данный момент.  

----
##### `string option(string key)`
Возвращает значение настройки с переданным именем **key**.  

----
##### `void set_option(string key, string value)`
Заменяет значение настройки с переданным именем **key** на переданное значение **value**.

## ScreenID

Файл game.h содержит объявление перечисления ScreenID и константы **SCREENID_DEFAULT**.  
В классе Game также содержится приватную функцию **create_screen(ScreenID)**, в которой находится switch, перебирающий значения ScreenID и создающий соответствующие классы-наследники Screen.  
Когда вы наследуете класс Screen, вам следует также добавить значение в перечисление ScreenID, включить заголовочный файл вашего класса в файл game.cpp и изменить функцию.  
В противном случае функция **[open_screen(ScreenID, bool)](05_Game.md#void-open_screenscreenid-sid-bool-reload-false)** не сможет создавать объекты вашего класса (хотя вы всё равно можете использовать функцию **[open_screen(Screen*)](05_Game.md#void-open_screenscreen-screen)**).

## Прочее

Объект Game содержит единственные экземпляры SDL_Surface окна, и объектов Loader, Input и State (указатели на них передаются в объекты класса Screen). Он также содержит настройки в объекте класса String_Table и указатель на открытый в данный момент объект Screen.  
   
   
**Предыдущий файл:** [класс Object](04_Object.md)  
**[Содержание](00_Contents.md)**  
**Следующий файл:** [Использование класса functor](06_Using_functors.md)

